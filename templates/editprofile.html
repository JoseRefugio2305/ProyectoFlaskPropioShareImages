{% extends "layout.html" %}
{% block content %}
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>



<div class="col-md-8 offset-md-2" style="text-align: center;">
    <h1>Editar Perfil</h1>
    <form action="/updateUser" method="POST" id="formedituser"  enctype="multipart/form-data" >
        <div class="form-group col-md-6 offset-md-3">
            <img src="{{userdata.5}}" class="linkimgprofilenav" id="imgprofileedit" width="150" height="150" alt="">
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="inputGroupFileAddon01"><i class="fas fa-file-import"></i></span>
                </div>
                <div class="custom-file">
                    <input accept="image/png,image/jpeg,image/gif"  type="file" class="custom-file-input" id="inputGroupFile01" name="imgprofileinput" aria-describedby="inputGroupFileAddon01" >
                    <label class="custom-file-label" for="inputGroupFile01" style="text-align: left;">Cambiar</label>
                </div>
            </div>
        </div>
    
        <div class="row">
            <div class="form-group col-md-6">
                <label>Nombre(s)</label>
                <input class="form-control" type="text" value="{{userdata.1}}" name="firstnameedit">
            </div>
            <div class="form-group col-md-6" >
                <label>Apellido(s)</label>
                <input class="form-control" type="text" value="{{userdata.2}}" name="lastnameedit">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group" >
                    <label>E-mail</label>
                    <input class="form-control" type="email" value="{{userdata.3}}" name="emailedit">
                </div>
                <div class="form-group" >
                    <label>Contrasena</label>
                    <input class="form-control" type="password" value="{{userdata.4}}" id="pass" name="passedit">
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group" >
                    <label>Genero</label>
                    <select class="form-control" required name="generoedit">
                        {% with gender = ['H','M', 'O']%}
                        {% if userdata.8 == gender.0%}
                        <option value="M">Mujer</option>
                        <option value="H" selected>Hombre</option>
                        <option value="O">Otro</option>
                        {% endif %}
                        {% if userdata.8 =='M' %}
                        <option value="M" selected>Mujer</option>
                        <option value="H">Hombre</option>
                        <option value="O">Otro</option>
                        {% endif %}
                        {% if userdata.8 == 'O' %}
                        <option value="M" >Mujer</option>
                        <option value="H">Hombre</option>
                        <option value="O" selected>Otro</option>
                        {% endif %}
                        {% endwith %}
                    </select>
                    
                </div>
                <div class="form-group" >
                    <label>Fecha de Nacimiento</label>
                    <input class="form-control" type="date" value="{{userdata.9}}" name="dateedit">
                </div>
            </div>
            
        </div>
    
    </form>
    <div class="form-group row" >
        <div class="col-md-6">
            <button class="btn btn-success form-control" onclick="ConfirmEdition()" disabled id="GuardarEdicion">
                Guardar
            </button>
        </div>
        <div class="col-md-6">
            <button class="btn btn-secondary form-control" disabled id="CancelarEdicion">
                Cancelar
            </button>
        </div>
    </div>


    <script>
        
        var modified=false;
        $(document).ready(function () 
        {   //esta parte ayuda a saber si alguno de los campos fue modificado para asi activar los botonoes de
            //guardar y cancelar
            $("input, select").change(function () {   
                modified = true;
                document.getElementById("GuardarEdicion").removeAttribute("disabled");
                document.getElementById("CancelarEdicion").removeAttribute("disabled");
            }); 
        });
        
        document.getElementById("inputGroupFile01").onchange = function(e) {
        // Creamos el objeto de la clase FileReader
        let reader = new FileReader();

        // Leemos el archivo subido y se lo pasamos a nuestro fileReader
        reader.readAsDataURL(e.target.files[0]);

        // Le decimos que cuando este listo ejecute el cÃ³digo interno
        reader.onload = function(){
            $('#imgprofileedit').attr("src",reader.result);
        };
        }

        function ConfirmEdition(){
            
            Swal.fire({
            title: 'Estas seguro?',
            text: "Los Cambios seran guardados!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Confirmar',
            
            }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById("formedituser").submit();
            }
            });
                
            
        }
    </script>
</div>
{% endblock %}